<!doctype html>
<html lang="fr">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>POC e‑santé – Administration</title>
    <link rel="stylesheet" href="css/base.css" />
    <link rel="stylesheet" href="css/admin.css" />
    <script src="https://cdn.jsdelivr.net/npm/sockjs-client@1/dist/sockjs.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@stomp/stompjs@7.0.0/bundles/stomp.umd.min.js"></script>
  </head>
  <body>
    <header class="topbar">
      <div class="brand">POC e‑santé</div>
      <nav class="nav">
        <a href="admin.html">Administration</a>
        <a href="gateway.html">Passerelle</a>
        <a href="dashboard.html">Tableau de bord</a>
        <a href="reports.html">Rapports</a>
      </nav>
    </header>

    <main>
      <section>
        <h2>Administration</h2>
        <div class="card" id="who"></div>

        <h3>Créer un utilisateur</h3>
        <form id="user-form" class="card form-grid">
          <div><label>Prénom</label><input id="u-prenom" required /></div>
          <div><label>Nom</label><input id="u-nom" required /></div>
          <div><label>Email</label><input id="u-email" type="email" required /></div>
          <div><label>Mot de passe</label><input id="u-pass" type="password" required /></div>
          <div>
            <label>Rôle</label>
            <select id="u-role">
              <option>ADMIN</option>
              <option>DOCTEUR</option>
              <option>INFIRMIER</option>
              <option>PATIENT</option>
              <option>PROCHE</option>
            </select>
          </div>
          <div class="actions"><button type="submit">Créer</button></div>
        </form>

        <h3>Créer une fiche patient</h3>
        <form id="patient-form" class="card form-grid">
          <div>
            <label>Utilisateur (rôle PATIENT)</label>
            <select id="p-user"></select>
          </div>
          <div><label>Date de naissance</label><input id="p-naissance" type="date" /></div>
          <div><label>Sexe</label><input id="p-sexe" placeholder="M/F" /></div>
          <div><label>Taille (cm)</label><input id="p-taille" type="number" /></div>
          <div><label>Poids (kg)</label><input id="p-poids" type="number" step="0.01" /></div>
          <div><label>Pathologie principale</label><input id="p-patho" /></div>
          <div class="actions"><button type="submit">Créer patient</button></div>
        </form>

        <h3>Créer un proche</h3>
        <form id="proche-form" class="card form-grid">
          <div>
            <label>Utilisateur (rôle PROCHE)</label>
            <select id="pr-user"></select>
          </div>
          <div><label>Patient ID</label><input id="pr-patient-id" type="number" /></div>
          <div><label>Lien</label><input id="pr-lien" /></div>
          <div class="actions"><button type="submit">Créer proche</button></div>
        </form>

        <div class="card">
          <div class="list-header">
            <div>Utilisateurs (filtre par rôle)</div>
            <div class="spacer"></div>
            <select id="filter-role">
              <option value="">Tous</option>
              <option>ADMIN</option>
              <option>DOCTEUR</option>
              <option>INFIRMIER</option>
              <option>PATIENT</option>
              <option>PROCHE</option>
            </select>
          </div>
          <ul id="users-list" class="list"></ul>
        </div>
      </section>
  </main>

  <div id="toast" class="toast hidden"></div>

    <script type="module">import { ensureAuth } from './js/auth.js'; ensureAuth(['ADMIN']);</script>
    <script type="module" src="./js/admin.js"></script>
    <script type="module">
      import { connectNotifications } from './js/notifications.js';
      connectNotifications();
    </script>
  </body>
  </html>

